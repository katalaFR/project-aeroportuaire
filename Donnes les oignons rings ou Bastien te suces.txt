<!-- login.php -->

<?php
    session_start();
?>
<html>
    <head>
        <title>Gestion aéroporturaire - Page login</title>
        <meta charset="utf-8">
        <link href="style.css" rel="stylesheet">
    </head>
    <body>
        <section id="pageLogin">
            <h1>Connexion</h1>
            <div id="containerLogin">
                <form action="PagesAnnexes/pageLogin.php" method="get">
                    <input class="inputLogin" type="text" name="identifiant" placeholder="Identifiant">
                    <input class="inputLogin" type="password" name="motDePasse" placeholder="Mot de passe">
                    <input class="boutonValider" name="boutonValider" type="submit" value="Valider">
                </form>
            </div>
        </section>
        <?php
            if(isset($_GET) && isset($_GET["logfailed"])){
            echo("
                <section id='pageLogin'>
                    <div class='erreurLogin'>
                        <p>Connexion impossible</p>
                        <p>Veuillez réessayer</p>
                    </div>
                </section>
            ");
            }
        ?>
    </body>
</html>

---------------------------------------------------------------------------------------------

<!-- pageLogin.php -->

<?php
    include_once("fonctions.php");
    tentativeLogin();
?>

---------------------------------------------------------------------------------------------

<!-- fonctions.php -->

<?php
    session_start();

    //Tentative de login
    function tentativeLogin(){
        //Récupération du mail et du mot de passe entré en paramètre
        $identifiant = $_GET["identifiant"];
        $motDePasse = hash("sha256", $_GET["motDePasse"]."dRp@y7At2KyvHDb9Dk!b");

        //Création de la liaison à la base de donnée
        $liaison = mysqli_connect("localhost", "root", "", "bdd_aeroport") or exit(mysqli_error());

        //Création de la requête et récupération du résultat
        $requete = "SELECT * FROM employe WHERE mail = '$identifiant' AND mdpHache = '$motDePasse'";
        $resultat = mysqli_query($liaison, $requete);
        $resultat = mysqli_fetch_assoc($resultat);

        if ($resultat["idEmploye"] != false){
            header("location:"."http://localhost/SiteAeroport/acceuil.php");
        } else {
            header("Location:"."http://localhost/SiteAeroport/login.php"."?logfailed=true");
        }
    }
?>